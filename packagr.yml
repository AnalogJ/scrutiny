---
engine_enable_code_mutation: true
engine_cmd_compile:
  - go build -ldflags '-w -extldflags "-static"' -o scrutiny webapp/backend/cmd/scrutiny/scrutiny.go
  - 'GOOS=linux GOARCH=amd64 go build -ldflags "-X main.goos=linux -X main.goarch=amd64" -o scrutiny-web-linux-amd64 -tags "static" webapp/backend/cmd/scrutiny/scrutiny.go'
  - 'chmod +x scrutiny-web-linux-amd64'
  - 'GOOS=linux GOARCH=amd64 go build -ldflags "-X main.goos=linux -X main.goarch=amd64" -o scrutiny-collector-metrics-linux-amd64 -tags "static" collector/cmd/collector-metrics/collector-metrics.go'
  - 'chmod +x scrutiny-collector-metrics-linux-amd64'

engine_cmd_test: 'go test -v -tags "static" $(go list ./... | grep -v /vendor/)'
scm_enable_branch_cleanup: true
scm_release_assets:
  - local_path: scrutiny-web-linux-amd64
    artifact_name: scrutiny-web-linux-amd64
  - local_path: scrutiny-collector-metrics-linux-amd64
    artifact_name: scrutiny-collector-metrics-linux-amd64
