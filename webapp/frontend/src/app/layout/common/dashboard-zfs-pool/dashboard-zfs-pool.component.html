<div
        [ngClass]="{ 
            'border-green': pool.state === 'ONLINE',
            'border-yellow': pool.state === 'DEGRADED',
            'border-red': pool.state === 'FAULTED' || pool.state === 'OFFLINE' || pool.state === 'UNAVAIL'
        }"
        class="relative flex flex-col flex-auto p-6 pr-3 pb-3 bg-card rounded border-l-4 shadow-md overflow-hidden">
    
    <!-- Background icon -->
    <div class="absolute bottom-0 right-0 w-24 h-24 -m-6">
        <mat-icon class="icon-size-96 opacity-12"
                  [ngClass]="zfsService.getPoolStatusClass(pool.state)"
                  [svgIcon]="zfsService.getPoolStatusIcon(pool.state)"></mat-icon>
    </div>
    
    <!-- Pool header -->
    <div class="flex items-center">
        <div class="flex flex-col">
            <a (click)="viewPoolDetails()" 
               class="font-bold text-md text-secondary uppercase tracking-wider cursor-pointer hover:underline">
                {{ pool.name }}
            </a>
            <div class="font-medium text-sm" 
                 [ngClass]="getTimestampColorClass()" 
                 *ngIf="pool.updated_at">
                Last Updated on {{ pool.updated_at | date:'MMMM dd, yyyy - HH:mm' }}
            </div>
        </div>
        
        <div class="ml-auto">
            <button mat-icon-button [matMenuTriggerFor]="poolMenu">
                <mat-icon [svgIcon]="'more_vert'"></mat-icon>
            </button>
            <mat-menu #poolMenu="matMenu">
                <a mat-menu-item (click)="viewPoolDetails()">
                    <span class="flex items-center">
                        <mat-icon class="icon-size-20 mr-3" [svgIcon]="'assessment'"></mat-icon>
                        <span>View Details</span>
                    </span>
                </a>
            </mat-menu>
        </div>
    </div>

    <!-- Pool status message (compact) -->
    <div class="mt-4" *ngIf="pool.status && pool.status.trim()">
        <div class="text-xs text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 p-2 rounded">
            {{ pool.status.trim() }}
        </div>
    </div>
    
    <!-- Pool action message (compact) -->
    <div class="mt-2" *ngIf="pool.action && pool.action.trim() && !pool.action.toLowerCase().includes('no action required')">
        <div class="text-xs text-yellow-600 dark:text-yellow-300 bg-yellow-50 dark:bg-yellow-900 p-2 rounded">
            <strong>Action:</strong> {{ pool.action.trim() }}
        </div>
    </div>
    
    <!-- 4-Field Layout matching disk component -->
    <div class="flex flex-row flex-wrap mt-4 -mx-6">
        <!-- State Field -->
        <div class="flex flex-col mx-6 my-3 xs:w-full">
            <div class="font-semibold text-xs text-hint uppercase tracking-wider leading-none">State</div>
            <div class="mt-2 font-medium text-3xl leading-none" 
                 [ngClass]="zfsService.getPoolStatusClass(pool.state)">
                {{ pool.state | titlecase }}
            </div>
        </div>
        
        <!-- Last Scan Field -->
        <div class="flex flex-col mx-6 my-3 xs:w-full">
            <div class="font-semibold text-xs text-hint uppercase tracking-wider leading-none">Last Scan</div>
            <div class="mt-2 font-medium text-3xl leading-none" 
                 [ngClass]="getScanStatusClass()">
                {{ getScanStatus() }}
            </div>
        </div>
        
        <!-- Utilization Field -->
        <div class="flex flex-col mx-6 my-3 xs:w-full">
            <div class="font-semibold text-xs text-hint uppercase tracking-wider leading-none">Utilization</div>
            <div class="mt-2 font-medium text-3xl leading-none" 
                 [ngClass]="getUtilizationClass()">
                {{ getUtilizationPercentage() }}%
            </div>
        </div>
        
    </div>
    
    <!-- Enhanced Tree Structure -->
    <div class="mt-4" *ngIf="pool.vdevs && pool.vdevs.length > 0">
        <div class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">Device Configuration:</div>
        <div class="bg-gray-50 dark:bg-gray-800 rounded-lg p-3 space-y-1">
            <!-- Hierarchical vdev tree structure -->
            <div *ngFor="let vdev of getVdevTree(); let i = index" class="flex items-center text-xs relative"
                 [style.padding-left.rem]="(vdev.indent - 1) * 1.5">
                
                <!-- Tree connector lines -->
                <div class="flex items-center mr-2" *ngIf="vdev.indent > 1">
                    <div class="w-3 h-3 border-l-2 border-b-2 border-gray-300 dark:border-gray-600"></div>
                </div>
                
                <!-- Device Icon -->
                <mat-icon class="icon-size-14 mr-2" 
                          [class.text-orange-500]="vdev.vdev_type.includes('raidz')"
                          [class.text-purple-500]="vdev.vdev_type === 'mirror'"
                          [class.text-blue-500]="vdev.vdev_type === 'replacing'"
                          [class.text-gray-500]="vdev.vdev_type === 'disk'"
                          [class.text-red-500]="vdev.vdev_type === 'file'"
                          [svgIcon]="zfsService.getVdevIcon(vdev.vdev_type)"></mat-icon>
                
                <!-- Device Info -->
                <span class="flex-1 truncate" 
                      [class.font-semibold]="vdev.isGroup"
                      [class.text-gray-900]="vdev.isGroup"
                      [class.dark:text-gray-100]="vdev.isGroup"
                      [class.text-gray-700]="!vdev.isGroup"
                      [class.dark:text-gray-300]="!vdev.isGroup"
                      [title]="vdev.displayName">
                    {{ vdev.displayName }}
                </span>
                
                <!-- State Badge -->
                <span class="px-2 py-1 rounded text-xs font-medium ml-2"
                      [ngClass]="getStateClass(vdev.state)">
                    {{ vdev.state }}
                </span>
            </div>
        </div>
    </div>
</div>
